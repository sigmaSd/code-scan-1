<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- PWA -->
    <link rel="manifest" href="/pwa/manifest.json" />
    <script defer src="/pwa/app.js"></script>

    <meta name="theme-color" content="#007bff"/>
    <title>Camera Number Scanner (PWA)</title>
    <!-- Cropper.js CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <!-- Tesseract.js via CDN -->
    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js'></script>
    <!-- Cropper.js JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.js"></script>
</head>
<body>

    <h1>Scan Number via Camera</h1>

    <div class="container">
        <!-- Button to start the camera -->
        <button id="startCameraButton" class="button camera-button">Open Camera</button>

        <!-- Container for the live camera view and capture button -->
        <div id="cameraViewContainer" style="display: none;">
            <video id="liveVideo" playsinline autoplay muted></video> <!-- playsinline helps on iOS -->
            <button id="captureButton" class="button capture-button">Capture Photo</button>
        </div>

        <!-- Container for Cropper (to display captured image) -->
        <div id="cropContainer">
            <img id="imageToCrop" src="#" alt="Captured image to crop">
        </div>
        <!-- Add Retake Button -->
        <button id="retakeButton" class="button retake-button">Retake Photo</button>
        <button id="cropButton" class="button">Crop & Scan Area</button>


        <div id="status">
            Click 'Open Camera' to start.
        </div>

        <div id="result">
            <p id="extractedText"></p>
            <p id="extractedNumber"></p>
            <!-- Keep the link element for potential fallback or display, but hide it -->
            <a id="dialLink" href="#" class="button dial-button" target="_blank" style="display: none;">Dial Number</a>
            <p class="warning">Note: The app will attempt to open your dialer automatically. If it doesn't, you may need to copy the number manually.</p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
